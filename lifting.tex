\chapter{Separation and Lifting: Towards a Cutting-plane Algorithm}
\chplab{lifting}
In this chapter we show how \concept[valid inequality]{valid inequalities} can be used to develop \concepts{cutting plane algorithm}. A key issue in any \concept{cutting plane algorithm} is \concept{separation}. We illustrate how the \concept{separation problem} for specific classes of \concept[valid inequality]{valid inequalities} can be solved, by considering the \concept[cover inequality]{cover inequalities} for the \concept{knapsack problem} (\secref{knapsack}), and the \concept[subtour elimination inequality]{subtour elimination inequalities} for the \concept{traveling salesman problem} (\secref{salesman}). \concept{Lifting} is about strengthening \concept[valid inequality]{valid inequalities}; we apply this concept to the \concept[cover inequality]{cover inequalities} in \secref{coverineq}.

\section{Separation for the Knapsack Problem}
\seclab{knapsack}
Although one could argue that the \concept{knapsack problem} is a very specific problem featuring only a single \concept{constraint}, one should realize that any \concept{integer programming formulation} can be seen as an \concept{optimization problem} with many \concepts{knapsack constraint}. Thus, \concept[valid inequality]{valid inequalities} that we can derive from a \concept{knapsack constraint} are important since such an \concept{inequality} can be relevant for any \concept{integer program}. We restate the \concept{knapsack problem} (see \eqnnrefr{knapsack-m}{knapsack-c2} in \chpref{formulations}).

\begin{eqnarray}
\mbox{maximize}&\sumieqb[j]{1}{n}{c_j\cdot x_j}\eqnlab{knapsack4-m}\\
\mbox{subject to}&\sumieqb[j]{1}{n}{a_j\cdot x_j}\leq b\eqnlab{knapsack4-c1}\\
&\forall\rangei[j]{1}{n}:x_j\in\accl{0,1}\eqnlab{knapsack4-c2}
\end{eqnarray}

We assume, without loss of generality, that the parameters $a_1,a_2,\ldots,a_n$, and $b$ satisfy the following \concepts{condition}:

\begin{enumerate}
 \item selecting any single \concept{item} is a \concept{feasible solution}, or: $a_j\leq b$ for each $j$, and
 \item selecting all $n$ \concepts{item} is not a \concept{feasible solution}, or: $\sumieqb[j]{1}{n}{a_j}>b$.
\end{enumerate}

\begin{note}
Notice that these \concepts{condition} can be checked easily. In the sequel we will also assume (unless explicitly stated otherwise) that the \concepts{item} in the instance of the \concept{knapsack problem} are sorted according to decreasing weights $a_j$, that is, $a_1\geq a_2\geq\ldots\geq a_n$. In the following section, we will derive a set of \concept[valid inequality]{valid inequalities} for the \concept{knapsack problem} and we will use them to sketch a \concept{solution} approach for the \concept{knapsack problem}.
\end{note}

\subsection{Separation of Cover Inequalities}

\begin{example}
Consider the following \concept{linear programming relaxation} of an instance of the \concept{knapsack problem}.

\begin{eqnarray}
\mbox{maximize}&206\cdot x_1+180\cdot x_2+176\cdot x_3+170\cdot x_4+146\cdot x_5+110\cdot x_6\\
\mbox{subject to}&83\cdot x_1+75\cdot x_2+70\cdot x_3+68\cdot x_4+59\cdot x_5+45\cdot x_6\leq 170\\
&\forall\rangei[i]{1}{6}:0\leq x_i\leq 1
\end{eqnarray}

A solution of the \concept{linear programming relaxation} of this instance is $\vec{x}^{\star}=\tupl{0,0,1,1,\dfrac{32}{59},0}$. We can conclude from this \concept{LP-solution} that \concepts{item} $3$, $4$, and $5$ cannot simultaneously be part of a \concept{knapsack} solution. Hence, $x_3=x_4=x_5=1$ is impossible. Therefore, the following \concept{constraint} is a \concept{valid inequality}:
\begin{equation}
x_3+x_4+x_5\leq2.
\end{equation}
In fact, this \concept{constraint} is a \concept{violated valid inequality}, that is, the given solution $\vec{x}^{\star}$ violates this \concept[valid inequality]{inequality}.
\end{example}

\paragraph{}
In general, for a subset $C\subseteq\accl{1,2,\ldots,n}$ of the \concepts{item} with the property that $\sumdomain[j]{C}{a_j}\geq b$, we have the following \concept{valid inequality}:

\begin{equation}
\sumdomain[j]{C}{x_j}\leq\abs{C}-1
\end{equation}

Such an \concept{inequality} is called a \concept{cover inequality}. The set $C$ is called a \concept{cover}. More precisely, any set of \concepts{item} whose total \concept{weight} exceeds $b$ is a \concept{cover} with respect to this \concept{constraint}. Thus, as an aside, earlier in this section, we in fact assumed that $\accl{1,2,\ldots,n}$ is a \concept{cover}. The \concept[valid inequality]{inequality} above is clearly \concept[valid inequality]{valid}: any \concept{feasible solution} to the \concept{knapsack problem} cannot select all \concepts{item} from $C$ when $C$ is a \concept{cover}. A \concept{minimal cover} is a \concept{cover} with the property that the removal of any \concept{item} makes the \concept{total weight} of the remaining \concepts{item} drop to $b$ or less. In other words: $C$ is a \concept{minimal cover} if

\begin{equation}
\sumdomain[j]{C}{a_j}\leq b\xand\forall i\in C:\sumdomain[j]{C\setminus\accl{i}}{a_j}\leq b
\end{equation}

The problem we now face is to find, given some \concept{point} $\vec{x}^{\star}\in\RRR^n$, a \concept{cover inequality} for the \concept{knapsack problem} that is not satisfied by the given point. More formally, the \concept{separation problem} for the \concept[cover inequality]{cover inequalities} is:

\begin{definition}[Separation problem for cover inequalities]
Given $\vec{x}^{\star}\in\RRR^n$, find a \concept{cover} $C$ such that $\sumdomain[j]{C}{x_j^{\star}}>\abs{C}-1$, or establish that no such \concept{cover} exists.
\end{definition}

Such an \concept{inequality} is called a \concept{violated cover inequality}. In general, the \concept{separation problem} is hard for \concepts{hard problem}. However, if we restrict the search of a \concept{violated inequality} to a subset of the \concept[valid inequality]{valid inequalities}, the \concept{separation problem} restricted to this subset of \concept[inequality]{inequalities}, may be easier to solve. We will restrict ourselves here to the \concept[separation problem]{separation} of the \concept[cover inequality]{cover inequalities} for the \concept{knapsack problem}.

\paragraph{}
The \concept{separation problem} for the \concept[cover inequality]{cover inequalities} is now restated as follows. Let the \concept{point} $\vec{x}^{\star}\in\RRR^n$ be given. Is there a \concept{cover inequality} that is \concept[violated inequality]{violated} by $\vec{x}^{\star}$? In mathematical terms this problem can be described as follows.

\paragraph{}
Given $\vec{x}^{\star}$: Is there a $C\subseteq\accl{1,2,\ldots,n}$ with

\begin{eqnarray}
&&\sumdomain[j]{C}{x_j^{\star}}>\abs{C}-1\xand\eqnlab{sep-c1}\\
&&\sumdomain[j]{C}{a_j}>b\eqnlab{sep-c2}
\end{eqnarray}
To solve this problem we introduce \concepts{binary variable} $z_j$ ($j=1,\ldots,n$):

\begin{equation}
\semboolvar{z_j}{if $j$ is chosen in the cover $C$;}{otherwise.}
\end{equation}

These variables will determine which \concepts{item} are present in the \concept{cover}. The \concept{solution} $\vec{z}$ to be found should satisfy the following conditions.

\begin{equation}
1+\sumieqb[j]{1}{n}{x_j^{\star}\cdot z_j}>\sumieqb[j]{1}{n}{z_j}\eqnlab{setcoversep}
\end{equation}

Clearly, this \concept{inequality} follows from reformulating \eqnnref{sep-c1} by taking the newly defined $\vec{z}$-\concepts{variable} into account (notice that, by definition, $\abs{C}=\sumieqb[j]{1}{n}{z_j}$). Let us rewrite \concept{inequality} \eqnnref{setcoversep} by bringing all terms with $\vec{z}$-\concepts{variable} to the left hand side:

\begin{equation}
\sumieqb[j]{1}{n}{1-x_j^{\star}}\cdot z_j<1
\end{equation}

\paragraph{}
Consider now \concept{inequality} \eqnnref{sep-c2}. When we plug in the $\vec{z}$-\concepts{variable} into this \concept{inequality}, the following \concept{inequality} results:

\begin{equation}
\sumieqb[j]{1}{n}{a_j\cdot z_j}\geq b+1
\end{equation}

\paragraph{}
Summarizing all \concepts{condition}, we can formulate the \concept{separation problem} for the \concept[cover inequality]{cover inequalities} as the following \concept{minimization problem}.

\begin{eqnarray}
\mbox{minimize}&\eta=\sumieqb[j]{1}{n}{\brak{1-x_j^{\star}}\cdot z_j}\eqnlab{sepco-m}\\
\mbox{subject to}&\sumieqb[j]{1}{n}{a_j\cdot z_j}\geq b+1\eqnlab{sepco-c1}\\
\forall\rangei[j]{1}{n}&z_j\in\accl{0,1}\eqnlab{sepco-c2}
\end{eqnarray}

Suppose that we are able to solve \eqnnrefr{sepco-m}{sepco-c2}. Then, if $\eta<1$, a \concept{cover inequality} violated by $\vec{x}^{\star}$ has been found. If, on the other hand, $\eta\geq1$, then we haven't found a \concept{cover inequality} violated by $\vec{x}^{\star}$ (and for good reason: none exists!). Although the \concept{separation problem} for \concept[cover inequality]{cover inequalities}, i.e., solving \eqnnrefr{sepco-m}{sepco-c2} \concept{NP-hard} in general, the problem can become fairly easy for a given instance. This is due to the fact that there are usually only few \concepts{fractional value} in the \concept{solution} $\vec{x}^{\star}$. Indeed, items whose corresponding $\vec{x}^{\star}$-\concepts{variable} equal $1$ can always be added to the \concept{cover}; this follows from observing that \concept{objective function} \eqnnref{sepco-m} will not increase when selecting such an \concept{item} in the \concept{cover}. Also, \concepts{item} whose corresponding $\vec{x}^{\star}$-\concept{variable} equal $0$ can be safely excluded from the \concept{cover}, since selecting such an item will result in $\eta\geq 1$. In other words: if $x_j^{\star}=1$ then $z_j=1$, and if $x_j^{\star}=0$ then $z_j=0$. We illustrate this with the next example.

\begin{example}
\begin{equation}
79\cdot x_1+53\cdot x_2+53\cdot x_3+47\cdot x_4+45\cdot x_5\leq178
\end{equation}

A \concept{fractional solution} for this example: $\vec{x}^{\star}=\tupl{1,1,\frac{46}{53},0,0}$. To find a \concept{violated cover} we have to solve the problem (verify this!):

\begin{eqnarray}
\mbox{minimize}&\eta=\frac{7}{53}\cdot z_3+z_4+z_5\eqnlab{sepco-ex-m}\\
\mbox{subject to}&79\cdot z_1+53\cdot z_2+53\cdot z_3+47\cdot z_4+45\cdot z_5\geq 179\eqnlab{sepco-ex-c1}\\
\forall\rangei[j]{1}{5}&z_j\in\accl{0,1}\eqnlab{sepco-ex-c2}
\end{eqnarray}

As argued above, if $x_j^{\star}$, then $z_j=1$ as well (since the the coefficient of $z_j$ in \eqnnref{sepco-ex-m} equals zero). And,
since we are only interested in finding violated cover inequalities, x∗j = 0 implies zj = 0 (since zj = 1
gives η ≥ 1). Now, observe that the solution (z1 , z2 , z3 , z4 , z5 ) = (1, 1, 1, 0, 0) is feasible in (4.11)-(4.12),
and has objective function value less than 1. Thus, we have identified a violated cover inequality:
x1 + x2 + x3 ≤ 2.

In the following iterations of a cutting-plane algorithm, the number of fractional variables may increase
since the number of constraints increases. Therefore, identifying violated inequalities may become more
complicated in forthcoming steps.
\end{example}

Consider the following example.
51

max

77x1 + 6x2 + 3x3 + 6x4 + 33x5 + 13x6 + 110x7 + 21x8 + 47x9

s.t. 774x1 + 76x2 + 22x3 + 42x4 + 21x5 + 760x6 + 818x7 + 62x8 + 785x9 ≤ 1500
67x1 + 27x2 + 794x3 + 53x4 + 234x5 + 32x6 + 797x7 + 97x8 + 435x9 ≤ 1500
0 ≤ xi ≤ 1 for all i.

In the following table we see how the linear programming solution and its value develop after adding
violated cover inequalities. In the first table we give the solutions that are generated in the iterations.
In the second table the violated cover inequalities are given. Notice that we can derive cover inequalities
from both constraints.

Iteration

x1

x2

1

.71

2

x3

x4

x5

.35

1

1
.63

3
4

1

.35

1

Iteration

x6

x7

x8

x9

zLP

1

1

1

1

1

1

1

.61

204.8

1

1

.37

1

.63

177.1

1

1

1

1

225.7

176.0

Cover wrt constraint 1

Cover wrt constraint 2

1

x1 + x7 ≤ 1

x3 + x7 ≤ 1

2

x7 + x9 ≤ 1

3

x1 + x7 + x9 ≤ 1

Notice that the inequality x1 + x7 + x9 ≤ 1 is not a cover inequality. Indeed, although {1, 7, 9} is a
cover with respect to the first inequality, the right-hand side does not equal |C| − 1. This inequality is a
so-called extended cover inequality. The extended cover inequalities are the subject of section 4.3.
From the first table one can see that the number of fractional variables is small compared to the total
number of variables. Thus, the separation problem for the cover inequalities is fairly easy here. In
general, the number of fractional variables is bounded by the number of constraints of the problem at
hand. Although this number may increase, the number of fractional variables tends to remain limited.
This observation is true for many problems.


\section{Separation for the Traveling Salesman Problem}

Consider the following formulation of the symmetric traveling salesman problem, which uses a binary
variable xe indicating whether edge e is selected or not.

e ce xe

minimize
subject to

(4.13)

e∈δ(v)

xe = 2

e∈δ(S)

xe ≥ 2

xe ∈ {0, 1}

for all v ∈ V
for all S ⊂ V, |S| ≥ 2
for all e.

(4.14)
(4.15)
(4.16)

Obviously, constraints (4.14) ensure that each node must be incident to two edges; these constraints are
referred to as degree constraints. Constraints (4.15) state that, for each nodeset S ⊂ V , there at least two
edges with one endpoint in S and one endpoint not in S. These constraints are the subtour elimination
constraints.
When we replace the integrality constraints (4.16) by 0 ≤ xe ≤ 1, we have created a linear program that
we refer to as the subtour LP. Clearly, solving this subtour LP gives a lower bound to the optimal value
of the TSP instance. Notice however, that this subtour LP contains exponentially many constraints. We
will show how to solve the separation problem for the subtour elimination constraints efficiently, i.e., in
polynomial time. This implies that we can optimize over the subtour LP in polynomial time (despite the
exponential number of constraints).
So, let us assume we are given a vector x∗e , found, for instance, by optimizing (4.13) over the constraints
(4.14) and 0 ≤ xe ≤ 1. The question now is: does there exist a violated subtour elimination constraint?
In other words, is there a set S ⊂ V such that the left-hand side of (4.15) is less than 2? To answer this
question we build a network G consisting of nodes, edges, and a capacity for each edge as follows. There
is a node in G for each city in the TSP-instance, and there is an edge in the network for each e with
x∗e > 0. The capacity of this edge equals x∗e .
Proposition 4.2.1 The value of a minimum cut in G is less than 2 if and only if there exists a violated
subtour elimination constraint.
53

We leave it to the reader to verify this proposition. Concluding, by solving a minimum cut problem we
solve the separation problem for the subtour elimination constraints.

\section{Lifting: Extended Cover Inequalities}

Consider the example in Section 4.1. From the first constraint we could have obtained the valid inequality
x1 + x6 + x7 + x9 ≤ 1
. Indeed, since the coefficients of x1 , x6 , x7 and x9 are each larger than 750, no two of these variables
can both equal 1. Thus, this inequality is valid, and in fact, it is stronger that the corresponding cover
inequalities. Addition of this particular inequality to the linear programming relaxation would have
given the integral solution immediately. Unfortunately, this inequality is not part of the class of cover
inequalities. But we can derive it from a cover inequality with a technique called lifting.
Example Let S be the set of feasible solutions of the problem in the previous section. Consider the inequality x1 +x7 ≤ 1. This inequality is valid in the set of solutions restricted to the items {1, 2, 3, 4, 5, 7, 8},
i.e., it is valid for the set S ∩ {x ∈ IB 9 |x6 = x9 = 0}. We will now derive an inequality
x1 + αx6 + x7 ≤ 1
where α is chosen such that this inequality is valid for S ∩ {x ∈ IB 9 |x9 = 0}. In order to do so, we have
to evaluate two situations.
x6 = 0:

in this case the inequality remains valid trivially.

x6 = 1:

in this case each of the items 1 and 7 can not be taken into the knapsack because constraint 1
would be violated. Therefore, taking α = 1 maintains validity of the constraint.

This process can be repeated for item 9. It will lead to the inequality
x1 + x6 + x7 + x9 ≤ 1.
Notice that the resulting inequality is not a cover inequality (there are four variables on the lefthand side,
whereas the righthand side does not equal 3). This inequality belongs to the class of so-called extended
cover inequalities.
54

Recall that we have assumed that the items are indexed according to decreasing weight. Consider a
minimal cover C = {j1 , . . . , jk }. Then the corresponding extended cover E(C) is defined as
E(C) = {1, . . . , j1 − 1} ∪ C.
Thus, each item that is heavier than the heaviest item in the cover C is added in order to construct the
set of items E(C). We claim:
Theorem 4.1

j∈E(C)

xj ≤ |C| − 1 is a valid inequality for the knapsack problem.

The derivation of an extended cover inequality from a cover inequality can be seen as a special case
of a process called lifting. Given some valid inequality (say, a cover inequality) lifting refers to raising
coefficients of variables in this inequality in order to obtain a stronger, yet valid, new inequality (the
extended cover inequality). Indeed, the coefficients of variables x1 , x2 , . . . , xj1 −1 have value 0 in the cover
inequality, and have been raised to value 1 in the extended cover inequality. This principle, however, can
be applied in a more general way. In fact, lifting is a technique that can be used in many problems to
strengthen known classes of valid inequalities. The following theorems can be used repeatedly for this
purpose. In the theorems stated below, we assume that x is a n-dimensional {0, 1} vector, and that S
denotes the set of feasible x-vectors.
Theorem 4.2 Suppose that
Then αx1 +

n
j=2

n
j=2

πj xj ≤ π0 is valid for each x ∈ S with x1 = 0.

πj xj ≤ π0 is valid for each x ∈ S as long as α ≤ π0 − maxx∈S|x1 =1

Theorem 4.3 Suppose that
Then βx1 +

n
j=2

n
j=2

n
j=2

πj xj .

πj xj ≤ π0 is valid for each x ∈ S with x1 = 1.

πj xj ≤ π0 +β is a valid inequality for each x ∈ S as long as β ≥ maxx∈S|x1 =0

n
j=2

πj xj −

π0 .
Notice that applying Theorem 4.2 does not change the righthand side, whereas applying Theorem 4.3
may change the righthand side. In the remainder of this section we give an example in which the two
theorems above are applied repeatedly.
Example Consider the knapsack constraint
3x1 + x2 + x3 + x4 + x5 ≤ 4.
55

(4.17)

As before, let S be the set of (binary) feasible solutions of this constraint. Suppose that we fix the values
of the first three variables as follows:
x1 = 1, x2 = x3 = 0.
Plugging in these values in (4.17) reduces the inequality to x4 + x5 ≤ 1. Thus x4 + x5 ≤ 1 is valid for
each x ∈ S with x1 = 1, x2 = x3 = 0.
We now lift variable x3 by applying Theorem 4.2. This gives (using α3 as coefficient for x3 ): find a
maximal α3 such that α3 x3 + x4 + x5 ≤ 1 is valid for each in x ∈ S with x1 = 1, x2 = 0, x3 = 1. This is
equivalent to determining a maximal α3 such that
α3 ≤ 1 −

max

x∈S|x1 =1,x2 =0,x3 =1

x4 + x5 .

It follows that α3 = 1. In other words, we can conclude that x3 + x4 + x5 ≤ 1 is valid for all x ∈ S with
x1 = 1, x2 = 0.
We now proceed by lifting variable x1 using Theorem 4.3. This gives (using β1 as coefficient for x1 ): find
a minimal β1 such that β1 x1 + x3 + x4 + x5 ≤ 1 + β1 is valid for each x ∈ S with x1 = x2 = 0. This is
equivalent to determining a minimal β1 such that
β1 ≥

(x3 + x4 + x5 ) − 1.

max

x∈S|x1 =x2 =0

It follows that β1 = 2. Thus, we conclude that 2x1 + x3 + x4 + x5 ≤ 3 is valid for all x ∈ S with x2 = 0.
Finally, we lift variable x2 using Theorem 4.2. This gives (using α2 as coefficient for x2 ): find a maximal
α2 such that 2x1 + α2 x2 + x3 + x4 + x5 ≤ 3 is valid for each x ∈ S with x2 = 1. This is equivalent to
determining a maximal α2 such that
α2 ≤ 3 −

max

x∈S|x2 =1

2x1 + x3 + x4 + x5 .

It follows that α2 = 0. We arrive at the conclusion that the resulting inequality
2x1 + x3 + x4 + x5 ≤ 3

(4.18)

is a valid inequality for each x ∈ S. Notice that we have derived a new inequality (4.18) that is stronger
than the original one (4.17). As an example, consider the solution x = ( 13 , 0, 1, 1, 1), and observe that
this particular solution is cut off by (4.18), while it is not violated by (4.17).
56

Here we have lifted the variables x1 , x2 and x3 in the sequence x3 , x1 , x2 . It is interesting to notice that
different sequences may yield different inequalities. For instance, the sequence x3 , x1 , x2 produces another
inequality. Thus, the order of lifting influences the final inequality we get, see Exercise 4.

\section{Applications}

Knapsack constraints are embedded in many structured problems. Two obvious examples are the multiknapsack problem and the generalized assignment problem. We will give their respective formulations
below.
The multi-knapsack problem

n

cj xj

(M KP ) max

(4.19)

j=1
n

aij xj ≤ bi

s.t.

for all i = 1, 2, . . . , m

(4.20)

for all j = 1, 2, . . . , n

(4.21)

j=1

xj ∈ {0, 1}

The generalized assignment problem

m

n

cij xij

(GAP ) max

(4.22)

i=1 j=1
n

s.t.

aij xij ≤ bi

for all i = 1, 2, . . . , m

(4.23)

for all j = 1, 2, . . . , m

(4.24)

for all i = 1, 2, . . . , m, for all j = 1, 2, . . . , n.

(4.25)

j=1
m

xij ≤ 1
i=1

xij ∈ {0, 1}

57

\section*{Exercises}
\begin{exercise}
Find all inequalities, induced by minimal covers, of the following knapsack inequality:
79x1 + 53x2 + 53x3 + 45x4 + 45x5 ≤ 178.
Can you find an extended cover inequality?
\end{exercise}

\begin{exercise}
Consider the following knapsack problem.
max

3x1 + 2x2 + x3

s.t.

4x1 + 3x2 + 2x3 ≤ 6
x1 , x2 , x3 ∈ {0, 1}

Solve this problem with a cutting-plane algorithm.
\end{exercise}

\begin{exercise}
It is clear that one can use the simplex-method to find the linear programming relaxation of the knapsack
problem as formulated by (1.10)-(1.12). However, we claim that there is a much easier way:
Sort the items such that
c1
c2
cn
≥
≥ ... ≥
,
a1
a2
an
and next fill the knapsack with items 1, 2, . . . , k − 1, until item k can only be fractionally added to the
knapsack. In other words, we claim that the following solution is an optimal linear programming solution
to the knapsack problem.



1


k−1
xj =
(b − j=1 aj )/ak



 0

for all j = 1, 2, . . . , k − 1
if j = k
for all j = k + 1, . . . , n.

Can you prove this?

Apply this to the example in Section 4.1.
\end{exercise}

\begin{exercise}
Consider the example in Section 4.3. What inequality results if the variables are lifted in the sequence
x2 , x1 , x3 ? And what inequality results when using x1 , x2 , x3 as lifting sequence?
\end{exercise}