\chapter{Circuits Schakelen}
\chplab{circuitsschakelen}
\begin{chapterintro}
Tot slot bieden we een laatste gedeelte over het bouwen van digitale schakelingen in de praktijk. Dit gedeelte is optioneel. Het is geen leerstof, staat niet in de presentaties en vorm zeker geen onderdeel tijdens het examen. Het is dan ook eerder tot stand gekomen voor ``enthousiastelingen'' die de opgedane kennis in de praktijk willen omzetten. In dit hoofdstuk beschrijven we welke ge\"integreerde circuits men zich dient aan te schaffen om de schakelingen te implementeren. In de rest van het deel worden enkele projecten besproken die men kan realiseren.
\end{chapterintro}
\section{Anatomie van een Ge\"integreerd circuit}
We beginnen het hoofdstuk met de terminologie die men hanteert bij ge\"integreerde circuits.
\subsection{DIP packing}
Vermits het de bedoeling is dat men de circuits zelf implementeert, zullen we ook enkel werken met ge\"integreerde circuits die men zelf kan ineenzetten. Meestal kiest men daarvoor voor ``DIP packing''. DIP packing beschouwt rechthoekige chips met verbindingen in de lengte. \figref{dip8-packing} geeft dit concept grafisch weer.
\begin{figure}[hbt]
\centering
\importtikzsubfigure{dip8-packing}{Structuur}
\importtikzsubfigure{dip8-front}{Vooraanzicht}
\importtikzsubfigure{dip8-side}{Zijaanzicht}
\caption{DIP packing}
\end{figure}
Een verbinding noemt men een ``pin'' of ``pootje''. Omdat chips correct geori\"enteerd moeten worden maakt men gebruik van twee systemen. De ``notch'' is een cirkelvormige inkeping aan \'e\'en kant van de chip. Daarnaast zet men op de meeste chips ook een ``index marker''. Een index marker is een cirkel in de buurt van pin 1. Wanneer we de notch aan de linkerkant plaatsen (zoals op de figuur), worden de pootjes onderaan van links naar rechts genummerd. De nummering van de bovenste pootjes verloopt van rechts naar links. Elke digitale chip beschikt telkens over minstens twee pootjes: de power pin (ofwel \mbox{Vcc}) en de ground pin (ofwel \mbox{GND}). Bij de meeste chips stelt pin 1 de ground pin door. Meestal stelt de laatste pin (pin 8 op \figref{dip8-packing}) de power pin voor. Soms gebruikt men ook de eerste pin van de bovenste rij (pin 5 op \figref{dip8-packing}). De powerpin moet worden verbonden met de positieve pool van de voeding, de ground pin met de negatieve pool. In een schematische voorstelling van een ge\"integreerd circuit geeft men vaak de nummers van de verschillende pinnen weer. Een diagram die de functie van de verschillende pinnen beschrijft noemt men een ``pinout''. \figref{dip8-front} en \figref{dip8-side} tonen het voor- en zijaanzicht van een DIP ge\"integreerd circuit. Doorgaans zijn de pootjes dikker rond het midden van de chip dan het einde. De structuur van DIP vereist bijna dat het aantal pootjes altijd even is. Indien dit niet het geval is zal men meestal een veelvoud van de componenten in een chip implementeren. Zo bestaan er bijvoorbeeld chips die $4$ NAND-poorten aanbieden.
\subsection{Populaire ge\"integreerde circuits}
Nu we de structuur van een ge\"integreerd circuit hebben voorgesteld, zullen we een bondige samenvatting geven over de belangrijkste ge\"integreerde circuits. Belangrijke ge\"integreerde circuits werden gestandaardiseerd met een nummer. Op gebied van digitale elektronica spreekt men over twee ``ge\"integreerde circuit-families'': de 74000 serie en de 4000 serie. De 74000 serie omvat digitale componenten ge\"implementeerd met transistor-transistor logic. De 4000 serie implementeert dezelfde schakelingen in CMOS-logica. Indien we dus Zo stelt ge\"integreerd circuit 4068 een 8-NAND poort voor in CMOS logica. 47068 biedt dezelfde poort aan, maar volgens een andere technologie.
\paragraph{}
\importtabulartable{popular-ic}{Lijst met populaire ge\"integreerde circuits.}
In \tblref{popular-ic} staat een lijst met populaire ge\"integreerde circuits. Naast de digitale circuits omvat de tabel ook enkele analoge schakelingen. De werking van deze circuits wordt verder in dit hoofdstuk verduidelijkt.
\section{Analoge componenten}
Naast ge\"integreerde circuits zal men in de praktijk in een digitale schakeling ook analoge componenten aantreffen: weerstanden, condensatoren, transistoren en in mindere mate spoelen. In deze sectie geven we een kort overzicht. Voor een volledige lijst van de ge\"integreerde circuits in de 74000 en 4000 families: zie \cite{74000icfamily,4000icfamily}.
\subsection{Weerstanden}
%Een weerstand is een component die de spanning en stroomsterkte tussen componenten kan verlagen.
\subsubsection{Kleurcode}
Op de meeste weerstanden wordt de weerstand niet in cijfers weergegeven, maar volgens een kleurencode.
\subsection{Transistoren}
\subsection{Condensatoren}
\subsection{Spoelen}
\subsection{Diodes}
\section{Bouw van een elektronische schakeling}
\subsection{Matrixbord}
\subsection{Europrintplaat}
\importtikzfigure{europrint}{Structuur van een europrintplaat.}
Een europrintplaat is een stap tussen een matrixbord en speciaal ontwikkelde printplaat. In een europrintplaat beschouwen we een rechthoekige bord van kunststof. Op deze plaat brengt men in een rasterstructuur rechthoekige plaatjes van koper aan. Zo'n plaatje bevat drie gaten waarop men de verbindingen van de componenten kan solderen. Hierdoor zijn de componenten die verbonden zijn met de drie gaten verbonden met elkaar. Deze structuur is ge\"illustreerd op \figref{europrint}.
\subsection{Printed Circuit Board (PCB)}
Wanneer men een schakeling heeft ontwikkeld die men wil realiseren in een klein formaat gebruikt men meestal een ``Printed Circuit Board (PCB)'' of ``printplaat''. Een printplaat is een op maat gemaakte plaat waarbij de verbindingen gerealiseerd worden door een koperen laag aan de ene kant van deze plaat. De componenten worden op deze plaat bevestigt door openingen in de plaat. De componenten worden aan de andere kant bevestigd waarbij de verbindingen door de openingen op het koper worden bevestigd.
\paragraph{}
Men kan printplaten op twee manieren bekomen: ze bestellen bij een bedrijf die hierin gespecialiseerd is of ze zelf maken. Bij beide dient men eerst de printplaat te ontwerpen.
\subsubsection{Ontwerp}
Het ontwerp van een printplaat is een proces waarin men bepaald hoe de koper-laag er zal uitzien samen met de locaties van de openingen.
\subsubsection{Productieproces}
In deze subsubsectie zullen we het productieproces om zelf printplaten te maken bondig beschrijven. Meer informatie over dit proces is te vinden in \cite{fabricatingprintedcircuitboards}.
\paragraph{}
Het proces bestaat grofweg uit vier fases: ``blootstelling'', ``etsen'', ``tin betegeling'' en ``boren''\cite[p. 69]{fabricatingprintedcircuitboards}. In de volgende paragrafen zullen we de fases bespreken.
\paragraph{Blootstelling}
\paragraph{Etsen}
\paragraph{Tin betegeling}
\paragraph{Boren}
\subsection{Plaatsen van componenten}
\subsection{Tips bij het solderen}
\section{Implementatie van een kloksignaal}
In de cursus hebben we telkens abstractie gemaakt van de implementatie van een kloksignaal: een signaal die met een bepaalde frequentie afwisselend $0$ en $1$ aanlegt. Hoe kunnen we een dergelijk signaal implementeren? Een eerste antwoord zou kunnen zijn dat men een sequenti\"ele schakeling bouwt die dit signaal zal aanleggen. Het probleem is dat een dergelijke schakeling zelf een kloksignaal nodig heeft. We zullen dus een ander component nodig hebben. Twee populaire keuzes zijn het gebruik van een $555$-timer en een kristal-oscillator. We zullen beide technieken kort bespreken.
\subsection{555-timer}
De $555$-timer\footnote{Soms uitgesproken als ``triple five'' of ``triple five timer''.} is een ge\"integreerd circuit die gebruikt wordt om allerhande periodieke functies te implementeren. Het component kost los rond de $\$ 2.50$. Een 555-timer kan kloksignalen produceren tot ongeveer $300\mbox{ kHz}$.
\subsubsection{Pinout en interface}
Een $555$-timer is een component met $8$ verbindingen. \figref{pinout-555} geeft de pinout van de chip met DIP packing weer.
\begin{figure}[hbt]
\centering
\importtikzsubfigure{pinout-555}{555-timer pinout}
\importtikzsubfigure{interface-555}{555-interface}
\importtikzsubfigure{pinout-556}{556-timer pinout}
\caption{De pinout van de 555-timer en 556-timer.}
\end{figure}
In een blokdiagram tekent men een $555$-timer meestal met vaste posities voor de verschillende in- en uitgangen. \figref{interface-555} toont deze posities samen met de nummers van de pinout.
\subsubsection{Werking}
De werking van de $555$-timer is niet eenvoudig te verklaren. Dit komt omdat men een dergelijk timer implementeert met complexe analoge elektronica zoals operationele versterkers. Zonder in detail te treden zullen we verklaren hoe we een $555$-timer als kloksignaal kunnen gebruiken. De ground pin en de power pin leggen een spanning aan op het component zodat het kan functioneren. Daarnaast bevat de $555$-timer een interne flipflop. De toestand van deze flipflop ($0$ of $1$) wordt aangelegd op de output pin. Twee ingangen dienen vervolgens om het signaal om te wisselen: de \mbox{trigger} en de \mbox{threshold}. De \mbox{trigger} is een ingang die de flipflop op $1$ zet op het moment dat de spanning hoger wordt dan $1/3$  van de spanning die op de \mbox{Vcc} staat. De \mbox{threshold} werkt omgekeerd: de ingang is gevoelig voor spanning boven $2/3$ van de spanning op de \mbox{Vcc}. Indien op dat moment de trigger een spanning heeft groter dan $1/3$, wordt de flipflop terug op $0$ gezet. De overige pinnen zijn van minder belang. De controle pin kan de waarde van de threshold aanpassen. Wanneer we dus een vaste kloksignaal willen genereren is het belangrijk dat de control pin ten alle tijde op een vaste spanning staat. Daarom wordt de controle pin meestal via een condensator verbonden met de negatieve pool van de stroombron. Vermits een condensator behoudt van spanning nastreeft, is dit dus de beste garantie op een constante spanning op de controle-ingang. De \mbox{discharge} ingang is een verbinding die stroom naar de ground laat vloeien op het moment dat de \mbox{output} hoog is. Wanneer de \mbox{output} laag is, is de \mbox{discharge} hoog impedant. De \mbox{reset} pin ten slotte zal de output terug op $0$ zetten wanneer men een lage spanning\footnote{Beneden een spanning van $0.8\mbox{ V}$ tegenover de ground.} aanlegt. Meestal is de \mbox{reset}-ingang aangesloten op de positieve pool van de stroombron om dit te vermijden.
\paragraph{}
\importtikzfigure{clock-555}{Schakeling voor de implementatie van een kloksignaal met een $555$-timer}
Op basis van de beschrijving kunnen we een eenvoudige schakeling met een RC-keten ontwerpen die een kloksignaal zal genereren. Deze schakeling staat beschreven in \figref{clock-555}. Op het moment dat men een spanning op de schakeling aanlegt, is de condensator $C_1$ niet opgeladen en het \mbox{output}-signaal van de $555$-timer is hoog. Bijgevolg wordt de condensator opgeladen door de RC-keten. Op het moment dat de spanning van de condensator (de spanning tussen pin 1 en pin 6) $2/3$ van de totale spanning bereikt, wordt de \mbox{output} op laag gezet. Vanaf dat moment begint de condensator te ontladen. De spanning over de condensator neemt bijgevolg af en op het moment dat spanning onder $1/3$ van de totale spanning gaat, detecteert de \mbox{trigger} dit. Op dat moment wordt de \mbox{output} terug hoog en begint de cyclus opnieuw. Omdat het opladen en ontladen van tussen $1/3$ en $2/3$ van de spanning in de RC-keten even lang duurt, is de duty cycle bijgevolg 50\%. \figref{clock-555} toont ook de spanning van de \mbox{output} en de condensator op verschillende momenten in de tijd. De stippellijnen op de grafiek van de condensator tonen het verdere verloop van de functie indien de \mbox{output}-niet zou worden omgedraaid.
\paragraph{}
De frequentie van het kloksignaal hangt duidelijk af van de parameters van de RC-keten. Een condensator wordt op- en ontladen volgens volgende functies:
\begin{eqnarray}
\fun{U_{\mbox{op}}}{t}&=&U_f-\brak{U_f-U_0}\cdot e^{-t/R_1\cdot C_1}\\
\fun{U_{\mbox{ont}}}{t}&=&U_0\cdot e^{-t/R_1\cdot C_1}
\end{eqnarray}
Met $U_0$ de beginspanning en $U_f$ de spanning die op de keten wordt aangelegd. In een halve klokcyclus wordt de spanning dus opgeladen van $1/3\ V$ naar $2/3\ V$ of ontladen van $2/3\ V$ naar $1/3\ V$. De tijd die hierbij verstrijkt is dus gelijk aan:
\begin{equation}
\Delta t=-R_1\cdot C_1\cdot\fun{\ln}{1/2}=\fun{\ln}{2}\cdot R_1\cdot C_1\approx 0.693147181 R_1\cdot C_1
\end{equation}
De frequentie van het kloksignaal is bijgevolg gelijk aan:
\begin{equation}
f=\displaystyle\frac{1}{2\Delta t}=\displaystyle\frac{1}{2\cdot\fun{\ln}{2}\cdot R_1\cdot C_1}=\displaystyle\frac{1}{\fun{\ln}{4}\cdot R_1\cdot C_1}\approx\displaystyle\frac{0.72134752}{R_1\cdot C_1}
\end{equation}
Meer informatie over de implementatie, de werking en concrete oscillator-schakelingen is te vinden in \cite{ne555}.
\subsubsection{556-timer}
Tot slot introduceren we ook nog een andere populaire ge\"integreerde schakeling: de $556$-timer. Deze ge\"integreerde schakeling is eigenlijk niets anders dan twee $555$-timers in \'e\'en chip. Het voordeel van dergelijke chips is dat bepaalde in- en uitgangen gedeeld kunnen worden. In het geval van de $556$-timer is dat het geval voor de power pin en ground pin.
\subsection{Astabiele multivibrator}
Een andere manier om een kloksignaal te implementeren is door een oscillator te implementeren. De meeste oscillatoren werken op basis van het volgende principe: een we beschouwen een transistor die een zekere weerstand tussen de collector en emitor aanbrengt. De weerstand wordt bepaald door de spanning tussen de basis en de emitor. Door een schakeling te implementeren die de weerstand negatief terugkoppelt naar de basis en hierover een zekere tijd laat verstrijken kunnen we een oscillator bouwen. Een dergelijke feedback schakeling moet dus in het geval van een PNP-transistor bij een lage weerstand de spanning op de basis verlagen en bij een hoge weerstand de spanning aan de basis opdrijven.
\paragraph{}
\importtikzfigure{twopnp}{Astabiele multivibrator.}
Een typische manier om dit te realiseren is een symmetrische schakeling met twee PNP-transistoren en twee RC-ketens zoals ge\"illustreerd op \figref{twopnp}. Deze schakeling werkt als volgt. We beschouwen een toestand waarbij de eerste transistor gesloten is\footnote{Een transistor is gesloten wanneer er stroom vloeit van de collector naar de emitor. In het ander geval is de transistor open.} en de andere transistor gesloten.
\subsection{Kristal-oscillator}
Een nadeel van de $555$-timer is dat de periodieke functie meestal niet nauwkeurig wordt aangelegd. Componenten op basis van transistoren en weerstanden zijn bijvoorbeeld onderhevig aan de temperatuur. Indien men dus een kloksignaal met een zekere frequentie aanlegt kan men fluctuaties op die frequentie verwachten. Zolang de frequentie laag is, levert dit weinig problemen op: de componenten rekenen immers zo snel dat de data lang op de ingangen van de registers staat alvorens ze worden ingeladen. Wanneer men echter een processor implementeert, wil men een hoge kloksnelheid die zo weinig mogelijk tijd de data onbenut laat. Ook bij hoge frequenties blijft er echter sprake van ruis. In dat geval kan de ruis het verschil maken tussen de correcte data die aan de ingang van een register staat, of oude of tijdelijke data.
\paragraph{}
In dergelijke gevallen zal men opteren voor een kristal-oscillator. Een kristal-oscillator werk op basis van pi\"ezo-elektromagnetisme. De fysica achter dit proces valt buiten het bereik van deze cursus. Men kan echter stellen dat het een component is die op basis van een kwartskristal met een zeer vaste frequentie van weerstand varieert. De afwijkingen worden dan ook uitgedrukt in ``parts per billion (ppb)''.
\section{Printed Circuit Board (PCB) Layout}
In vakbladen zal men meestal naast de schakeling ook een ``printed circuit board (pcb) layout'' weergeven. Dit is een schematische weergave hoe men de schakeling compact kan realiseren op een printplaat. Een dergelijke afbeelding dient niet om de schakeling te analyseren, maar enkel om de schakeling zelf op een effici\"ente manier te realiseren. Een probleem met dergelijke plannen is dat men andere symbolen gebruikt om de componenten voor te stellen: meestal wordt de basisvorm van het relevante component weergegeven, bovendien dient men ook twee lagen weer te geven: de boven- en onderkant van de printplaat.
\paragraph{}
De meeste afbeeldingen lossen het probleem van de twee lagen op met behulp van kleur: in deze cursus zullen we de voorzijde afbeelden in het zwart en de achterzijde in het grijs. Het probleem met het toewijzen van componenten wordt meestal aangepakt door de componenten te labelen. Meestal wordt hierbij het type component (weerstand, condensator, ...) weergegeven, maar de meest relevante eenheid van het component. Zo zal bij een condensator de capaciteit in micro-Farad worden weergegeven.
\paragraph{}
Bij wijze van introductie toont \figref{pcb-components} een overzicht van de symbolische weergaven van enkele populaire componenten.
\begin{figure}[hbt]
\centering
\importtikzsubfigure{pcb-rcy}{Condensator}
\importtikzsubfigure{pcb-alf}{Diode}
\importtikzsubfigure{pcb-dip}{DIP-chip}
\importtikzsubfigure{pcb-wire}{Draad}
\importtikzsubfigure{pcb-hc49}{Kristal-oscillator}
\importtikzsubfigure{pcb-led}{LED}
\importtikzsubfigure{pcb-tact}{Schakelaar}
\importtikzsubfigure{pcb-to92}{Transistor}
\importtikzsubfigure{pcb-led}{USB-verbinding}
\importtikzsubfigure{pcb-acy}{Weerstand}
\caption{PCB-weergave van populaire componenten.}
\figlab{pcb-components}
\end{figure}
\paragraph{}
Een PCB-layout kan ook digitaal worden ingevoerd. Bijvoorbeeld met \emph{gEDA} of \emph{Gerber}. Bovendien kan deze software op basis van de gegevens een lijst met specificaties maken waar gaten in de printplaat moeten worden geboord, waar de geleiders moeten worden aangebracht en welke componenten worden gebruikt en waar deze moeten worden aangebracht. Dit proces kan bovendien worden geautomatiseerd door relevante apparatuur aan te sturen. Dit ligt buiten het bereik van deze cursus.
\section{Oproep aan de lezers}
De auteur roept enthousiaste lezers op om projecten te delen zodat deze in deze cursus kunnen worden gepubliceerd als een hoofdstuk in dit deel. Men kan echter niet elk project als nuttig beschouwen. Ingediende projecten moeten aan enkele voorwaarden voldoen:
\begin{enumerate}
 \item De componenten in het project dienen in de cursus vermeld te worden. Het is niet de bedoeling om ``exotische componenten'' te introduceren, in het bijzonder denken we dan aan componenten uit de analoge elektronica (operationele versterker, spoel, ...). Sommige projecten kunnen een klein aantal van dit soort componenten bevatten. In dat geval dient men een korte beschrijving van de werking bij te voegen.
 \item Het project moet realiseerbaar zijn. Zowel op een op maat gemaakte printplaat als bijvoorbeeld een europrintplaat. Verder is het evenmin de bedoeling dat het project veel werk vereist en het resultaat weinig inzichten zal verwerken (hierbij denken we bijvoorbeeld aan een 1024-bit opteller).
 \item De effecten die in het project beschreven worden moeten te verklaren zijn, en dit op basis van de cursus.
\end{enumerate}
Indien het project aan deze voorwaarden voldoet maakt het kans om opgenomen te worden. Een lezer kan een project indienen op volgend adres: \url{http://goo.gl/rzIlr3}. Een ``aanvraag'' bestaat uit \'e\'en of meerdere schema's samen met een verslag. Dit verslag bevat een lijst van benodigde componenten, aanwijzingen bij de bouw van de schakeling en een tekst die de werking verklaart. Het verslag mag figuren bevatten die de werking verder uitleggen. Omdat een dergelijke aanvraag veel werk vraagt, kan men ook een ``voor-aanvraag'' indienen (op hetzelfde webadres). In een voor-aanvraag specificeert men kort het project in een tekst van maximaal \'e\'en pagina. Op basis van de reactie van de auteur kan men dan beslissen om al dan niet een aanvraag in te dienen.