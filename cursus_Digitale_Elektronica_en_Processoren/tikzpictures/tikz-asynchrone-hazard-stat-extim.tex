\begin{tikzpicture}
\def\dye{0.7};
\def\dy{0.5};
\def\de{0.2};
\def\dxe{0.6};
\coordinate (XE) at (8*\dxe,0);
\draw[thick,->] (0,-0.1) -- (0,5*\dye+\de);
\draw[thick,->] (-0.1,0) -- (XE);
\foreach \i/\t in {0/$f$,1/$q$,2/$p$,3/$y'$,4/$y$} {
  \draw (0,\dye*\i+0.5*\dy+0.5*\de) node [scale=0.8,anchor=east] {\t};
  \coordinate (I\i-0) at (0,\dye*\i+0.5*\de);
  \coordinate (I\i-1) at (0,\dye*\i+0.5*\de+\dy);
  \draw[dotted] (I\i-0) -- ++(8*\dxe,0);
  \draw[dotted] (I\i-1) -- ++(8*\dxe,0);
}
\foreach \i/\j/\k/\x in {4/0/1/1,3/1/0/2,2/1/0/3.4,1/0/1/4.4} {
  \coordinate (E\i-0) at (\x*\dxe,\dye*\i+0.5*\dy+0.5*\de);
  \draw[thick] (I\i-\j) -- (I\i-\j -| E\i-0) |- (I\i-\k -| XE);
}
\foreach \i/\j/\k/\xa/\xb in {0/1/0/5.4/6.4} {
  \coordinate (E\i-0) at (\xa*\dxe,\dye*\i+0.5*\dy+0.5*\de);
  \coordinate (E\i-1) at (\xb*\dxe,\dye*\i+0.5*\dy+0.5*\de);
  \draw[thick] (I\i-\j) -- (I\i-\j -| E\i-0) |- (I\i-\k -| E\i-1) |- (I\i-\j -| XE);
}
\foreach \ia/\xa/\ib/\xb in {4/0/3/0,4/0/2/0,3/0/1/0,2/0/0/0,1/0/0/1} {
  \coordinate (MID) at ($0.5*(E\ia-\xa)+0.5*(E\ib-\xb)$);
  \draw[->,gray] (E\ia-\xa) .. controls (E\ia-\xa -| MID) and (E\ib-\xb -| MID) .. (E\ib-\xb);
}
\end{tikzpicture}